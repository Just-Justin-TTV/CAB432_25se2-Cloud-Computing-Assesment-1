<!-- 
This template renders the sign-in page with:
- Animated background pattern
- Login form with username and password
- Links to register and reset password
- Modal for resetting password
-->
{% extends "base.html" %}
{% load static %}

{% block head %}
<style>
.animated-pattern {
    position: fixed;
    inset: 0;
    z-index: -10;
    background: linear-gradient(135deg, #15b97b 0%, #00a388 20%, #008d8c 40%, #007584 60%, #195e72 80%, #2f4858 100%);
    background-size: 200% 200%;
    animation: Animation 10s ease-in-out infinite;
}
@keyframes Animation {
    0% {background-position: 10% 0%;}
    50% {background-position: 91% 100%;}
    100% {background-position: 10% 0%;}
}
</style>
{% endblock %}

{% block content %}
{% if messages %}
<ul class="mb-4 space-y-2">
    {% for message in messages %}
        <li class="text-sm px-3 py-2 rounded
            {% if 'error' in message.tags %}bg-red-100 text-red-700{% endif %}
            {% if 'success' in message.tags %}bg-green-100 text-green-700{% endif %}">
            {{ message }}
        </li>
    {% endfor %}
</ul>
{% endif %}

<div class="min-h-screen flex items-center justify-center px-4 relative">
  <div class="animated-pattern"></div>

  <div class="bg-white bg-opacity-10 backdrop-blur-lg rounded-3xl p-8 shadow-2xl w-full max-w-md transform hover:scale-105 transition-all duration-300 z-10">
    
    <!-- Logo -->
    <div class="w-24 h-24 mx-auto mb-5 rounded-full ring-2 ring-white/20 shadow-md bg-white overflow-hidden">
      <img src="{% static 'images/img4.jpg' %}" alt="Logo" class="object-contain ring-2 ring-white/20 p-2" />
    </div>

    <h2 class="text-4xl font-extrabold text-white mb-2 text-center">Sign in</h2>

    <!-- Login Form -->
    <form method="post" class="space-y-4">
      {% csrf_token %}
      <input name="username" required placeholder="Username" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-20 focus:bg-opacity-30 focus:ring-2 focus:ring-emerald-300 text-white placeholder-white/60" />
      <input name="password" type="password" required placeholder="Password" class="w-full px-4 py-3 rounded-lg bg-white bg-opacity-20 focus:bg-opacity-30 focus:ring-2 focus:ring-emerald-300 text-white placeholder-white/60" />
      <button type="submit" class="w-full bg-gradient-to-r from-emerald-500 to-teal-400 text-white font-bold py-3 px-4 rounded-lg hover:opacity-90 focus:ring-4 focus:ring-emerald-300 transition duration-300">Sign In</button>
    </form>

    <!-- Links to reset password and register -->
    <div class="text-center mt-4">
      <a href="#" onclick="document.getElementById('reset-password-modal').classList.remove('hidden'); return false;" class="text-white/80 hover:underline text-sm">Forgot Password?</a>
    </div>

    <p class="text-white/90 text-center mt-6">
      Don't have an account? <a href="{% url 'register' %}" class="font-bold hover:underline text-white">Register</a>
    </p>

    <!-- Reset Password Modal -->
    <div id="reset-password-modal" class="hidden fixed inset-0 z-20 flex items-center justify-center bg-black/50">
      <div class="bg-white rounded-2xl p-6 w-full max-w-md shadow-lg">
        <h3 class="text-xl font-bold mb-4 text-center text-gray-800">Reset Password</h3>
        <form method="post">
          {% csrf_token %}
          <!-- Step 1: Enter username to send reset code -->
          <input name="reset_username" placeholder="Username" class="w-full px-4 py-3 mb-2 rounded-lg border border-gray-300" required />
          <button type="submit" name="send_code" class="w-full bg-emerald-500 text-white font-bold py-2 px-4 rounded-lg mb-4">Send Reset Code</button>

          <!-- Step 2: Enter code and new password -->
          <input name="reset_code" placeholder="Reset Code" class="w-full px-4 py-3 mb-2 rounded-lg border border-gray-300" />
          <input name="new_password" type="password" placeholder="New Password" class="w-full px-4 py-3 mb-2 rounded-lg border border-gray-300" />
          <button type="submit" name="confirm_reset" class="w-full bg-emerald-500 text-white font-bold py-2 px-4 rounded-lg">Confirm & Login</button>
          <button type="button" onclick="document.getElementById('reset-password-modal').classList.add('hidden');" class="text-gray-500 hover:underline mt-2">Cancel</button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
